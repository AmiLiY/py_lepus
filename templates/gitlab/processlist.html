{% extends "../base.html" %}
<!DOCTYPE html>
{% block header %}
    <script type="text/javascript" src={{ static_url("js/ext-all.js")}}></script>
    <script data-require="jquery@*" data-semver="2.0.3" src={{ static_url("js/jquery-2.0.3.min.js") }}></script>
    <script data-require="bootstrap@2.3.2" data-semver="2.3.2" src={{ static_url("js/bootstrap.min.js") }}></script>
    <script type="text/javascript" charset="utf-8" src={{ static_url("js/angular.min.js") }}></script>
    <script src={{ static_url("js/common.js") }}></script>
    <SCRIPT type="text/javascript" src={{ static_url("js/jquery-latest.js") }}></script>

{% end %}
{% block content %}
    <div class="panel panel-primary">
        <div class="panel-heading"><span class="glyphicon glyphicon-hdd"></span> {{ title }}</div>
        <form class="form-search">
            <button class="btn btn-default" onclick="send('do_merge,19,1,2,3')">合并</button>
            <input type="button" id="btn5" value="获得选中的所有值">
        </form>
        <table class="table table-striped table-hover table-bordered">
            <thead>
            <tr>
            <th width="10"><input type="button" id="btn1" value="全选"></th>
                <th>
                    id
                </th>
                {% for col in heads %}
                 <th ng-click="predicate='{{ col }}'; reverse=!reverse" class="sortBtn lp_{{ col }}">
                    <span ng-if="predicate=='{{ col }}'" ng-switch on="reverse">
                    </span>
                   {{ lang.get(col,col) }}
                </th>
                {% end %}
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in data">
            <td width="10"><input type="checkbox" name="checkbox" ></td>
               <td>// $index + 1 // </td>
               {% for col in heads %}
                   <td class="lp_{{ col }}"><span style="color:green;"> // item.{{ col }} // </span></td>
               {% end %}
            </tr>
            </tbody>
        </table>
    </div>
    <div id="myDiv1">操作日志：
        <input style="float: right;" onclick="cleanlog()" type=Button value="清除日志">
        <textarea id="responseText" style="background:#222;width:1077px;height:300px;overflow-y:scroll;color:#eee" ></textarea>
    </div>
<script>
var socket;
if (!window.WebSocket) {
    window.WebSocket = window.MozWebSocket;
}
// Javascript Websocket Client   
if (window.WebSocket) {
    socket = new WebSocket("ws://" + window.location.host + "/websocket");
    socket.onmessage = function(event) {
        var ta = document.getElementById('responseText');
        ta.value = ta.value + '\n' + event.data;
        //document.getElementById("responseText").scrollTop = document.getElementById("responseText").scrollHeight;
    };
    socket.onopen = function(event) {
        var ta = document.getElementById('responseText');
        ta.value = "Web Socket opened!";
    };
    socket.onclose = function(event) {
        var ta = document.getElementById('responseText');
        ta.value = ta.value + "Web Socket closed";
    };
} else {

    alert("Your browser does not support Web Socket.");
}
// Send Websocket data   
function send(message) {
    if (!window.WebSocket) {
        return;
    }
    if (socket.readyState == WebSocket.OPEN) {
        socket.send(message);
    } else {
        alert("The socket is not open.");
    }
}
       $("document").ready(function() {
       $("#btn1").click(function() {
            $("[name='checkbox']").attr("checked", 'true'); //全选
            console.log("11")
       })
       $("#btn2").click(function() {
            $("[name='checkbox']").removeAttr("checked"); //取消全选
       })
       $("#btn3").click(function() {
            $("[name='checkbox']:even").attr("checked", 'true'); //选中所有奇数
       })
       $("#btn4").click(function() {
            $("[name='checkbox']").each(function() {
                 if ($(this).attr("checked")) {
                      $(this).removeAttr("checked");
                 } else {
                      $(this).attr("checked", 'true');
                 }
            })
       })
       $("#btn5").click(function() {
            var str = "";
            $("[name='checkbox'][checked]").each(function() {
                 str += $(this).parent().val;
                 console.log(str)
            })
            alert(str);
       })
  }) 

</script>
{% end %}

